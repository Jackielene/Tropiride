import{r as n,j as e,H as g,L as m,a as v}from"./app-DATJSk02.js";import{A as y}from"./app-layout-BK_GRsZZ.js";import{C as w,b as C,c as _,d as D,a as S}from"./card-B1S1KxgK.js";import{A as b,a as M,b as A}from"./ErrorBoundary-C5KTbpzX.js";import{B as o}from"./badge-DjzpHOc_.js";import{B as a}from"./button-Cpvsye0R.js";import{D as I,a as U,b as R,c as H,d as L,e as P}from"./dialog-YWNqUz2A.js";import{c as k}from"./createLucideIcon-CWJud2Xx.js";import{C as x}from"./car-SnGofreg.js";import{P as z}from"./phone-Dd40m-Od.js";import{M as p}from"./map-pin-BF5AnyJa.js";/* empty css            */import"./index-DWv36XpW.js";import"./index-B4fuw4qc.js";import"./index-P1d-VrM6.js";import"./index-Cb992pyu.js";import"./index-Bs5OsWqX.js";import"./floating-ui.react-dom-DNRjgxbn.js";import"./index-BDQEw_oY.js";import"./index-D329iiHL.js";import"./index-CMWG4mbA.js";import"./index-CId40Vud.js";import"./message-square-CsFWhGY6.js";import"./app-logo-icon-D7ID7ruW.js";import"./shield-check-NGu4UIn8.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$=k("ArrowLeft",F);function pe({assignedBookings:r=[],driver:B}){const[i,c]=n.useState(null),[t,l]=n.useState(null),u=s=>s.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2),h=s=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s),f=s=>{switch(s){case"completed":return"default";case"pending":return"secondary";case"in_progress":return"outline";case"cancelled":return"destructive";default:return"outline"}},j=(s,d)=>{c(s),v.patch(`/driver/bookings/${s}/status`,{status:d},{preserveScroll:!0,onFinish:()=>{c(null)}})},N=()=>{t&&(j(t.bookingId,t.status),l(null))};return e.jsxs(y,{children:[e.jsx(g,{title:"My Rides - Driver"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 overflow-x-hidden p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-primary uppercase tracking-wide",children:"My Rides"}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Assigned Bookings"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage every ride youâ€™ve accepted and keep an eye on their status."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(a,{variant:"outline",asChild:!0,children:e.jsxs(m,{href:"/driver/dashboard",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})}),e.jsx(a,{asChild:!0,children:e.jsx(m,{href:"/driver/messages",children:"Go to Messages"})})]})]}),e.jsxs(w,{children:[e.jsxs(C,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5 text-primary"}),"My Rides"]}),e.jsx(D,{children:r.length?`You currently have ${r.length} ride${r.length>1?"s":""}.`:"No rides assigned yet. Accept bookings to start driving."})]}),e.jsx(S,{className:"p-0",children:r.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Customer"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Route"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Vehicle"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Schedule"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Fare"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-semibold text-xs uppercase text-muted-foreground",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{className:"h-10 w-10 border-2",children:[e.jsx(M,{src:s.customer?.email?`https://ui-avatars.com/api/?name=${encodeURIComponent(s.customer.name)}&background=0ea5e9&color=fff`:void 0}),e.jsx(A,{children:u(s.customer?.name||"Unknown")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.customer?.name||"Unknown"}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),s.customer?.phone??"No phone"]})]})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-start gap-2 max-w-xs",children:[e.jsx(p,{className:"h-3 w-3 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm truncate",children:s.pickup_location})]}),e.jsxs("div",{className:"flex items-start gap-2 max-w-xs",children:[e.jsx(p,{className:"h-3 w-3 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm truncate text-muted-foreground",children:s.dropoff_location})]}),s.distance_km&&e.jsxs("p",{className:"text-xs text-muted-foreground ml-5",children:[s.distance_km," km"]})]})}),e.jsxs("td",{className:"p-4",children:[s.vehicle_type&&e.jsx(o,{variant:"outline",className:"text-xs capitalize",children:s.vehicle_type}),s.passengers&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.passengers," pax"]})]}),e.jsx("td",{className:"p-4",children:s.pickup_date&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:new Date(s.pickup_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.pickup_time&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.pickup_time})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"font-semibold",children:h(s.total_amount||s.estimated_fare||0)})}),e.jsx("td",{className:"p-4",children:e.jsx(o,{variant:f(s.status),className:"text-xs capitalize",children:s.status.replace("_"," ")})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[s.status==="pending"&&e.jsx(a,{size:"sm",variant:"outline",onClick:()=>l({bookingId:s.id,status:"in_progress"}),disabled:i===s.id,children:"Start"}),s.status==="in_progress"&&e.jsx(a,{size:"sm",onClick:()=>l({bookingId:s.id,status:"completed"}),disabled:i===s.id,children:"Complete"})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(x,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"No assigned rides yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Once you accept a booking, it will appear here."})]})})]})]}),e.jsx(I,{open:!!t,onOpenChange:s=>!s&&l(null),children:e.jsxs(U,{children:[e.jsxs(R,{children:[e.jsx(H,{children:"Update Ride Status"}),e.jsx(L,{children:t?.status==="in_progress"?"Move this booking to In Progress? Customers will see that you have started the trip.":"Mark this booking as completed? This will finish the ride and archive it."})]}),e.jsxs(P,{className:"gap-2 sm:gap-0",children:[e.jsx(a,{variant:"outline",onClick:()=>l(null),children:"Cancel"}),e.jsx(a,{onClick:N,disabled:i===t?.bookingId,children:i===t?.bookingId?"Updating...":"Confirm"})]})]})})]})}export{pe as default};
