import{r as i,u as Qe,j as e,H as Xe,a as De}from"./app-D2KhOlPS.js";import{c as et,l as Fe,a as Ie,e as tt,d as at,M as st,T as rt,b as xe,L as Y,u as nt,f as lt}from"./leaflet--1lF0N13.js";import{F as pe,m as y,ao as it,b as z,j as H,aB as ct,D as ot,h as Me,an as dt,$ as Re,ay as mt,g as he,p as ut,i as O}from"./index-CXP4cl-V.js";import{T as xt}from"./TropirideNavbar-CCjgeLIB.js";import{D as pt,a as ht,b as gt,c as ft,d as yt,e as bt}from"./dialog-ChcKln-Q.js";import{B as Le}from"./button-DRgzOgcv.js";/* empty css            */import"./index-BHDVE5T7.js";import"./ErrorBoundary-DhJ2_a8D.js";import"./index-6XFs-mRv.js";import"./index-D5JU00dO.js";import"./index-C3HMWAIV.js";import"./createLucideIcon-EMwdt5a8.js";import"./index-C-hE0QHb.js";import"./clsx-B-dksMZM.js";function jt(c,a,r){a.center!==r.center&&c.setLatLng(a.center),a.radius!=null&&a.radius!==r.radius&&c.setRadius(a.radius)}const vt=et(function({center:a,children:r,...l},u){const b=new Fe.Circle(a,l);return Ie(b,tt(u,{overlayContainer:b}))},jt),Nt=at(function(a,r){const l=new Fe.Popup(a,r.overlayContainer);return Ie(l,r)},function(a,r,{position:l},u){i.useEffect(function(){const{instance:m}=a;function w(N){N.popup===m&&(m.update(),u(!0))}function U(N){N.popup===m&&u(!1)}return r.map.on({popupopen:w,popupclose:U}),r.overlayContainer==null?(l!=null&&m.setLatLng(l),m.openOn(r.map)):r.overlayContainer.bindPopup(m),function(){r.map.off({popupopen:w,popupclose:U}),r.overlayContainer?.unbindPopup(),r.map.removeLayer(m)}},[a,r,u,l])});delete Y.Icon.Default.prototype._getIconUrl;Y.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const K=[9.8349,126.045];function wt({center:c,zoom:a}){const r=nt();return i.useEffect(()=>{a?r.setView(c,a,{animate:!0,duration:.8,easeLinearity:.25}):r.setView(c,14,{animate:!0,duration:.8,easeLinearity:.25})},[r,c,a]),null}function kt({onMapClick:c}){return lt({click:a=>{const{lat:r,lng:l}=a.latlng;c(r,l)}}),null}async function Pe(c){if(!c||c.trim().length<2)return[];try{const a=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(c+", Siargao, Philippines")}&limit=5&addressdetails=1`,l=await(await fetch(a,{headers:{"User-Agent":"Tropiride App"}})).json();return l&&Array.isArray(l)?l.map(u=>({lat:parseFloat(u.lat),lng:parseFloat(u.lon),address:u.display_name.split(",").slice(0,3).join(",").trim()})):[]}catch(a){return console.error("Geocoding error:",a),[]}}async function ae(c,a){try{const r=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${c}&lon=${a}&zoom=18&addressdetails=1`,u=await(await fetch(r,{headers:{"User-Agent":"Tropiride App"}})).json();if(u&&u.display_name){const b=u.display_name.split(",");return b.slice(0,Math.min(3,b.length)).join(",").trim()}return`Location (${c.toFixed(6)}, ${a.toFixed(6)})`}catch(r){return console.error("Reverse geocoding error:",r),`Location (${c.toFixed(6)}, ${a.toFixed(6)})`}}function St(c){let r;c<=2?r=18:c<=5?r=25:c<=10?r=35:c<=20?r=45:r=50;const l=c/r*60,u=1.2;let b=0;c<=2?b=3:c<=5?b=2:c<=10?b=1.5:b=1;const m=2+l*u+b;return Math.max(3,Math.round(m))}const g={tricycle:{capacity:3,dailyRate:300,name:"Tricycle"},tuktuk:{capacity:4,dailyRate:400,name:"Tuk-Tuk"},"habal-habal":{capacity:2,dailyRate:250,name:"Habal-Habal"},multicab:{capacity:8,dailyRate:500,name:"Multicab"},van:{capacity:14,dailyRate:700,name:"Van"}};function Ut(){const{flash:c}=Qe().props,[a,r]=i.useState(null),[l,u]=i.useState(null),[b,m]=i.useState(K),[w,U]=i.useState(null),[N,ge]=i.useState(null),[Z,fe]=i.useState(null),[se,W]=i.useState(!1),[T,P]=i.useState(!0),[$e,F]=i.useState(!1);i.useEffect(()=>{c?.status&&F(!0)},[c]);const[Ee,D]=i.useState(!1),[q,J]=i.useState(null),[Ae,re]=i.useState(14),[_e,ne]=i.useState(!1),[ze,le]=i.useState(!1),[ye,j]=i.useState(""),[be,R]=i.useState(""),[v,Q]=i.useState([]),[ie,G]=i.useState([]),[He,V]=i.useState(!1),[Ue,I]=i.useState(!1),[je,ve]=i.useState("pickup"),[x,Ne]=i.useState(""),[$,we]=i.useState(""),[p,ke]=i.useState(""),[E,Se]=i.useState(""),[A,ce]=i.useState(""),[o,B]=i.useState("multicab"),[M,qe]=i.useState(1),Ge=i.useRef(null),Ce=i.useRef(null),X=i.useRef(null),_=i.useRef(null);i.useEffect(()=>{if(!x||!p){ce("");return}const t=x+($?` ${$}`:" 00:00"),s=p+(E?` ${E}`:" 00:00"),n=new Date(t).getTime();new Date(s).getTime()<n?ce("Return date/time must be after or equal to pickup date/time"):ce("")},[x,$,p,E]),i.useEffect(()=>{P(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(async t=>{const{latitude:s,longitude:n,accuracy:d}=t.coords;J(d),D(!0);try{const h=await ae(s,n);r({lat:s,lng:n,address:h}),j(h),m([s,n])}catch{r({lat:s,lng:n,address:"Current Location"}),j("Current Location"),m([s,n])}D(!1),P(!1)},t=>{r({lat:K[0],lng:K[1],address:"Siargao Island"}),j("Siargao Island"),P(!1),J(null)},{enableHighAccuracy:!1,timeout:1e4,maximumAge:6e4}):(r({lat:K[0],lng:K[1],address:"Siargao Island"}),j("Siargao Island"),P(!1))},[]),i.useEffect(()=>{if(v.length>0){const t=v.map(n=>n.lat),s=v.map(n=>n.lng);if(t.length>0&&s.length>0){const n=(Math.min(...t)+Math.max(...t))/2,d=(Math.min(...s)+Math.max(...s))/2,h=Math.max(...t)-Math.min(...t),k=Math.max(...s)-Math.min(...s),L=Math.max(h,k);let f=14;L>.05?f=12:L>.02?f=13:L>.01?f=14:f=15,m([n,d]),re(f)}}else a&&!v.length&&(re(14),m([a.lat,a.lng]))},[v,a]),i.useEffect(()=>{if(a&&l){const s=(l.lat-a.lat)*Math.PI/180,n=(l.lng-a.lng)*Math.PI/180,d=Math.sin(s/2)*Math.sin(s/2)+Math.cos(a.lat*Math.PI/180)*Math.cos(l.lat*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2),k=6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)));ge(k);const L=St(k);fe(L);let f=0;if(x&&p){const S=new Date(x),C=new Date(p),de=C.getTime()-S.getTime(),ee=Math.ceil(de/(1e3*60*60*24));if(ee===0||S.toDateString()===C.toDateString()){const me={"habal-habal":{base:20,perKm:6},tricycle:{base:25,perKm:8},tuktuk:{base:30,perKm:10},multicab:{base:35,perKm:10},van:{base:50,perKm:12}}[o];f=Math.round(me.base+k*me.perKm);const ue=g[o].capacity;M>ue&&(f=Math.round(f*1.1))}else{const Te=ee;f=g[o].dailyRate*Te;const ue=g[o].capacity;M>ue&&(f=Math.round(f*1.1))}}if(U(f),a&&l){const S=(a.lat+l.lat)/2,C=(a.lng+l.lng)/2;m([S,C])}else if(a&&!l)m([a.lat,a.lng]);else if(v.length>0&&!a){const S=v.map(te=>te.lat),C=v.map(te=>te.lng),de=(Math.min(...S)+Math.max(...S))/2,ee=(Math.min(...C)+Math.max(...C))/2;m([de,ee])}}else U(null),ge(null),fe(null)},[a,l,o,x,p,M]);const Ve=async()=>{navigator.geolocation?(P(!0),D(!0),navigator.geolocation.getCurrentPosition(async t=>{const{latitude:s,longitude:n,accuracy:d}=t.coords;J(d);try{const h=await ae(s,n);r({lat:s,lng:n,address:h}),j(h),m([s,n])}catch{r({lat:s,lng:n,address:"Current Location"}),j("Current Location"),m([s,n])}P(!1),D(!1)},t=>{P(!1),D(!1),J(null),alert("Location access denied or unavailable. Please enter your location manually or click on the map.")},{enableHighAccuracy:!1,timeout:1e4,maximumAge:6e4})):alert("Geolocation is not supported by your browser. Please enter your location manually.")},Be=async(t,s)=>{D(!0);try{const n=await ae(t,s),d={lat:t,lng:s,address:n};je==="pickup"?(r(d),j(n)):(u(d),R(n)),m([t,s])}catch{const n=`Location (${t.toFixed(6)}, ${s.toFixed(6)})`,d={lat:t,lng:s,address:n};je==="pickup"?(r(d),j(n)):(u(d),R(n))}D(!1)},Oe=async t=>{const n=t.target.getLatLng(),d=n.lat,h=n.lng;D(!0);try{const k=await ae(d,h);r({lat:d,lng:h,address:k}),j(k)}catch{r({lat:d,lng:h,address:`Location (${d.toFixed(6)}, ${h.toFixed(6)})`}),j(`Location (${d.toFixed(6)}, ${h.toFixed(6)})`)}D(!1)},Ke=async t=>{if(j(t),V(!0),X.current&&clearTimeout(X.current),_.current&&clearTimeout(_.current),!t.trim()){r(null),Q([]),V(!1);return}t.trim().length>=2?(ne(!0),_.current=setTimeout(async()=>{const s=await Pe(t);console.log("Pickup suggestions received:",s),Q(s),ne(!1)},400)):(Q([]),ne(!1))},oe=t=>{console.log("Selecting pickup location:",t),r(t),j(t.address),m([t.lat,t.lng]),re(14),V(!1),setTimeout(()=>{Q([]),Ce.current?.focus()},300)},Ye=async t=>{if(R(t),I(!0),X.current&&clearTimeout(X.current),_.current&&clearTimeout(_.current),!t.trim()){u(null),G([]),I(!1);return}t.trim().length>=2?(le(!0),_.current=setTimeout(async()=>{const s=await Pe(t);if(G(s),le(!1),s.length===1){const n=s[0];if(u(n),R(n.address),I(!1),G([]),a){const d=(a.lat+n.lat)/2,h=(a.lng+n.lng)/2;m([d,h])}else m([n.lat,n.lng])}},400)):(G([]),le(!1))},Ze=t=>{if(u(t),R(t.address),I(!1),G([]),a){const s=(a.lat+t.lat)/2,n=(a.lng+t.lng)/2;m([s,n])}else m([t.lat,t.lng])},We=()=>{if(!(!a||!l||!w||!N||!Z)){if(A){alert(A);return}W(!0),De.post("/tropiride/ride-request",{pickup_location:a.address,pickup_lat:a.lat,pickup_lng:a.lng,dropoff_location:l.address,dropoff_lat:l.lat,dropoff_lng:l.lng,estimated_fare:w,distance_km:N,estimated_time_minutes:Z,pickup_date:x&&$?`${x} ${$}`:x||null,return_date:p&&E?`${p} ${E}`:p||null,vehicle_type:o,passengers:M},{preserveScroll:!0,onSuccess:t=>{W(!1),t.props.flash?.status,F(!0),u(null),R(""),Ne(""),we(""),ke(""),Se("")},onError:t=>{W(!1),console.error("Error requesting ride:",t);const s=Object.entries(t).map(([n,d])=>(Array.isArray(d)?d:[d]).join(`
`)).join(`
`);alert(s?`Failed to send ride request:

${s}`:"Failed to send ride request. Please try again or contact support.")},onFinish:()=>{W(!1)}})}},Je=()=>{const t=a,s=ye;r(l),j(be),u(t),R(s),l&&m([l.lat,l.lng])};return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{title:"Book a Ride - Tropiride"}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(xt,{activeLink:"vehicles"}),e.jsxs("div",{className:"flex flex-col lg:flex-row h-[calc(100vh-4rem)]",children:[e.jsx("div",{className:"flex-1 relative z-0",children:e.jsxs(st,{center:b,zoom:14,style:{height:"100%",width:"100%",zIndex:0},zoomControl:!1,children:[e.jsx(rt,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.jsx(wt,{center:b,zoom:Ae}),e.jsx(kt,{onMapClick:Be}),v.length>0&&e.jsx(e.Fragment,{children:v.map((t,s)=>a&&a.lat===t.lat&&a.lng===t.lng?null:e.jsx(xe,{position:[t.lat,t.lng],eventHandlers:{click:()=>oe(t)},icon:Y.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),children:e.jsx(Nt,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold",children:t.address}),e.jsx("button",{onClick:()=>oe(t),className:"mt-2 px-3 py-1 bg-cyan-600 text-white rounded hover:bg-cyan-700 text-xs cursor-pointer",children:"Select as Pickup"})]})})},`suggestion-${s}`))}),a&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{position:[a.lat,a.lng],draggable:!0,eventHandlers:{dragend:Oe},icon:Y.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[32,48],iconAnchor:[16,48],popupAnchor:[1,-34],shadowSize:[41,41]})}),q&&q<100&&e.jsx(vt,{center:[a.lat,a.lng],radius:q,pathOptions:{fillColor:"#22d3ee",fillOpacity:.2,color:"#06b6d4",weight:2}})]}),l&&e.jsx(xe,{position:[l.lat,l.lng],icon:Y.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})})]})}),e.jsx("div",{className:"lg:w-96 w-full bg-white shadow-2xl overflow-y-auto",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Book a Ride"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Enter your locations to get started"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[e.jsx(pe,{className:"inline mr-2"}),"Choose Your Vehicle"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>B("habal-habal"),className:`cursor-pointer rounded-xl p-4 border-2 transition-all duration-200 ${o==="habal-habal"?"border-cyan-500 bg-cyan-50 shadow-lg":"border-gray-200 bg-white hover:border-cyan-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${o==="habal-habal"?"bg-cyan-500":"bg-gray-100"}`,children:e.jsx(it,{className:`text-xl ${o==="habal-habal"?"text-white":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:"Habal-Habal"}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 space-x-1.5 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-0.5 text-[9px]"}),g["habal-habal"].capacity," pax"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"font-medium text-cyan-600",children:["â‚±",g["habal-habal"].dailyRate,"/day"]})]})]})]}),o==="habal-habal"&&e.jsx(H,{className:"text-cyan-500 text-xl"})]})}),e.jsx(y.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>B("tricycle"),className:`cursor-pointer rounded-xl p-4 border-2 transition-all duration-200 ${o==="tricycle"?"border-cyan-500 bg-cyan-50 shadow-lg":"border-gray-200 bg-white hover:border-cyan-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${o==="tricycle"?"bg-cyan-500":"bg-gray-100"}`,children:e.jsx(ct,{className:`text-xl ${o==="tricycle"?"text-white":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:"Tricycle"}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 space-x-1.5 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-0.5 text-[9px]"}),g.tricycle.capacity," pax"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"font-medium text-cyan-600",children:["â‚±",g.tricycle.dailyRate,"/day"]})]})]})]}),o==="tricycle"&&e.jsx(H,{className:"text-cyan-500 text-xl"})]})}),e.jsx(y.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>B("tuktuk"),className:`cursor-pointer rounded-xl p-4 border-2 transition-all duration-200 ${o==="tuktuk"?"border-cyan-500 bg-cyan-50 shadow-lg":"border-gray-200 bg-white hover:border-cyan-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${o==="tuktuk"?"bg-cyan-500":"bg-gray-100"}`,children:e.jsx(pe,{className:`text-xl ${o==="tuktuk"?"text-white":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:"Tuk-Tuk"}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 space-x-1.5 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-0.5 text-[9px]"}),g.tuktuk.capacity," pax"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"font-medium text-cyan-600",children:["â‚±",g.tuktuk.dailyRate,"/day"]})]})]})]}),o==="tuktuk"&&e.jsx(H,{className:"text-cyan-500 text-xl"})]})}),e.jsx(y.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>B("multicab"),className:`cursor-pointer rounded-xl p-4 border-2 transition-all duration-200 ${o==="multicab"?"border-cyan-500 bg-cyan-50 shadow-lg":"border-gray-200 bg-white hover:border-cyan-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${o==="multicab"?"bg-cyan-500":"bg-gray-100"}`,children:e.jsx(pe,{className:`text-xl ${o==="multicab"?"text-white":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:"Multicab"}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 space-x-1.5 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-0.5 text-[9px]"}),g.multicab.capacity," pax"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"font-medium text-cyan-600",children:["â‚±",g.multicab.dailyRate,"/day"]})]})]})]}),o==="multicab"&&e.jsx(H,{className:"text-cyan-500 text-xl"})]})}),e.jsx(y.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>B("van"),className:`cursor-pointer rounded-xl p-4 border-2 transition-all duration-200 ${o==="van"?"border-cyan-500 bg-cyan-50 shadow-lg":"border-gray-200 bg-white hover:border-cyan-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${o==="van"?"bg-cyan-500":"bg-gray-100"}`,children:e.jsx(ot,{className:`text-xl ${o==="van"?"text-white":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:"Van"}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 space-x-1.5 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-0.5 text-[9px]"}),g.van.capacity," pax"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"font-medium text-cyan-600",children:["â‚±",g.van.dailyRate,"/day"]})]})]})]}),o==="van"&&e.jsx(H,{className:"text-cyan-500 text-xl"})]})})]})]}),e.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-cyan-800",children:e.jsx("strong",{children:"ðŸ’¡ How to select locations:"})}),e.jsxs("ul",{className:"text-xs text-cyan-700 mt-1 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Type in the search box to find places"}),e.jsx("li",{children:"Click on the map to set location"}),e.jsx("li",{children:"Use ðŸ“ button for GPS (optional - permission may be required)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(z,{className:"inline mr-2"}),"Number of Passengers"]}),e.jsx("select",{value:M,onChange:t=>qe(parseInt(t.target.value)),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 text-gray-900 bg-white hover:border-cyan-300 shadow-sm",children:[1,2,3,4,5,6,7,8,9,10,11,12,13,14].map(t=>e.jsxs("option",{value:t,children:[t," ",t===1?"Passenger":"Passengers"]},t))}),(()=>{const t=g[o].capacity,s=g[o].name;return M>t?e.jsxs("p",{className:"mt-2 text-sm text-orange-600 font-medium",children:["âš ï¸ ",s," typical capacity is ",t," passengers. Exceeding capacity will add 10% surcharge."]}):e.jsxs("p",{className:"mt-2 text-sm text-green-600 font-medium",children:["âœ“ ",s," can accommodate ",M," passenger",M>1?"s":""]})})()]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Pickup Location",T&&e.jsx("span",{className:"ml-2 text-xs font-normal text-cyan-600 animate-pulse",children:"(Getting your location...)"}),Ee&&e.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500",children:"(Updating address...)"}),q&&e.jsxs("span",{className:"ml-2 text-xs font-normal text-green-600",children:["(Accuracy: Â±",Math.round(q),"m)"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(y.div,{className:"w-3 h-3 rounded-full bg-green-500",animate:T?{scale:[1,1.3,1]}:{},transition:{duration:1,repeat:T?1/0:0}})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:Ge,type:"text",placeholder:T?"Detecting your location...":"Enter pickup location (e.g., Cloud 9, General Luna)",value:ye,disabled:T,onChange:t=>Ke(t.target.value),onFocus:()=>{ve("pickup"),v.length>0&&V(!0)},onBlur:()=>setTimeout(()=>V(!1),200),className:"w-full pl-10 pr-10 py-3 border-2 border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none transition-colors disabled:bg-gray-100 disabled:cursor-wait"}),He&&v.length>0&&e.jsx(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute z-50 w-full mt-1 bg-white border-2 border-cyan-200 rounded-xl shadow-lg max-h-60 overflow-y-auto",children:v.map((t,s)=>e.jsxs("button",{type:"button",onClick:()=>oe(t),className:"w-full text-left px-4 py-3 hover:bg-cyan-50 border-b border-gray-100 last:border-b-0 transition-colors flex items-start gap-3 cursor-pointer",children:[e.jsx(Me,{className:"text-cyan-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:t.address}),e.jsx("span",{className:"text-xs text-gray-500",children:"Click to select pickup location"})]})]},s))})]}),e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[_e&&e.jsx(y.div,{className:"w-4 h-4 border-2 border-cyan-600 border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),e.jsx("button",{onClick:Ve,disabled:T,className:"text-cyan-600 hover:text-cyan-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Use current location",children:e.jsx(y.div,{animate:T?{rotate:360}:{},transition:{duration:2,repeat:T?1/0:0,ease:"linear"},children:e.jsx(dt,{})})})]})]}),a&&!T&&e.jsxs(y.button,{initial:{opacity:0},animate:{opacity:1},onClick:()=>{r(null),j("")},className:"mt-2 text-xs text-red-600 hover:text-red-700 flex items-center gap-1",children:[e.jsx(Re,{className:"text-xs"}),"Clear"]})]}),a&&l&&e.jsx(y.button,{initial:{scale:0},animate:{scale:1},onClick:Je,className:"w-full py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors text-sm font-semibold text-gray-700",children:"Swap Locations"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Drop-off Location"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})}),e.jsx("input",{ref:Ce,type:"text",placeholder:"Enter drop-off location (e.g., Sugba Lagoon, Magpupungko)",value:be,onChange:t=>Ye(t.target.value),onFocus:()=>{ve("dropoff"),ie.length>0&&I(!0)},onBlur:()=>setTimeout(()=>I(!1),200),className:"w-full pl-10 pr-12 py-3 border-2 border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none transition-colors"}),ze&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(y.div,{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}),Ue&&ie.length>0&&e.jsx(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute z-50 w-full mt-1 bg-white border-2 border-red-200 rounded-xl shadow-lg max-h-60 overflow-y-auto",children:ie.map((t,s)=>e.jsxs("button",{type:"button",onClick:()=>Ze(t),className:"w-full text-left px-4 py-3 hover:bg-red-50 border-b border-gray-100 last:border-b-0 transition-colors flex items-start gap-3 cursor-pointer",children:[e.jsx(Me,{className:"text-red-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:t.address}),e.jsx("span",{className:"text-xs text-gray-500",children:"Click to select drop-off location"})]})]},s))})]}),l&&e.jsxs(y.button,{initial:{opacity:0},animate:{opacity:1},onClick:()=>{u(null),R("")},className:"mt-2 text-xs text-red-600 hover:text-red-700 flex items-center gap-1",children:[e.jsx(Re,{className:"text-xs"}),"Clear"]})]}),w&&w>0&&N&&Z&&x&&p&&e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl p-6 border-2 border-cyan-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Trip Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-500 rounded-full flex items-center justify-center",children:e.jsx(mt,{className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Distance"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[N.toFixed(2)," km"]})]})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(he,{className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Estimated Time"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[Z," min"]})]})]})}),e.jsx("div",{className:"pt-4 border-t border-cyan-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(ut,{className:"text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Estimated Fare"}),e.jsxs("p",{className:"text-2xl font-black text-gray-900",children:["â‚±",w]}),x&&p&&N&&(()=>{const t=new Date(x),s=new Date(p),n=s.getTime()-t.getTime(),d=Math.ceil(n/(1e3*60*60*24)),h=d===0||t.toDateString()===s.toDateString(),k=g[o].capacity,L=g[o].name,f=M>k;if(h){const C={"habal-habal":{base:20,perKm:6},tricycle:{base:25,perKm:8},tuktuk:{base:30,perKm:10},multicab:{base:35,perKm:10},van:{base:50,perKm:12}}[o];return e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[L," (Same-day): â‚±",C.base," base + â‚±",C.perKm,"/km Ã— ",N.toFixed(2),"km",f&&" + 10% surcharge"]})}else{const S=g[o].dailyRate;return e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[L," (Multi-day): â‚±",S,"/day Ã— ",d," day",d>1?"s":"",f&&" + 10% surcharge"]})}})(),(!x||!p)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select pickup and return dates"})]})]})})})]})]}),(!a||!l||!x||!p||!w||w===0)&&e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(O,{className:"text-blue-600 text-xl mt-0.5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Rental Requirements"}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"To calculate your estimated fare, please provide:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[e.jsxs("li",{className:a?"line-through opacity-60":"",children:["Pickup location ",a&&"âœ“"]}),e.jsxs("li",{className:l?"line-through opacity-60":"",children:["Dropoff location ",l&&"âœ“"]}),e.jsxs("li",{className:x?"line-through opacity-60":"",children:["Pickup date ",x&&"âœ“"]}),e.jsxs("li",{className:p?"line-through opacity-60":"",children:["Return date ",p&&"âœ“"]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-4 border-2 border-cyan-100",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[e.jsx(O,{className:"inline mr-2 text-cyan-600"}),"Pickup Date ",!x&&e.jsx("span",{className:"text-red-500",children:"*"}),x&&e.jsx("span",{className:"ml-2 text-xs text-green-600 font-normal",children:"âœ“ Set"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:x,onChange:t=>Ne(t.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-lg focus:border-cyan-500 focus:outline-none transition-colors cursor-pointer bg-white text-sm",style:{zIndex:10}}),e.jsx(O,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"Time"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"time",value:$,onChange:t=>we(t.target.value),className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-lg focus:border-cyan-500 focus:outline-none transition-colors cursor-pointer bg-white text-sm",style:{zIndex:10}}),e.jsx(he,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx("span",{className:"text-cyan-600",children:"â„¹ï¸"})," Leave empty for immediate ride"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-4 border-2 border-orange-100",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[e.jsx(O,{className:"inline mr-2 text-orange-600"}),"Return Date ",!p&&e.jsx("span",{className:"text-red-500",children:"*"}),p&&e.jsx("span",{className:"ml-2 text-xs text-green-600 font-normal",children:"âœ“ Set"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:p,onChange:t=>ke(t.target.value),min:x||new Date().toISOString().split("T")[0],className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none transition-colors cursor-pointer bg-white text-sm",style:{zIndex:10}}),e.jsx(O,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"Time"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"time",value:E,onChange:t=>Se(t.target.value),className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none transition-colors cursor-pointer bg-white text-sm",style:{zIndex:10}}),e.jsx(he,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]})]}),A&&e.jsx("div",{className:"mt-3 p-2.5 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx("span",{className:"text-red-500",children:"âš ï¸"}),A]})})]})]}),e.jsx(y.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:We,disabled:!a||!l||!x||!p||se||!!A,className:`w-full py-4 rounded-xl font-bold text-lg transition-all duration-200 ${a&&l&&x&&p&&!se&&!A?"bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:shadow-xl hover:shadow-cyan-500/50 cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:se?"Requesting Ride...":"Request Ride"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 space-y-2",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," Our drivers will pick you up at your specified location. You'll receive real-time updates once a driver accepts your request."]}),e.jsxs("p",{className:"text-xs text-blue-700",children:["ðŸ“ ",e.jsx("strong",{children:"Select location:"})," Click anywhere on the map or drag the green marker to set your pickup point."]})]})]})})]})]}),e.jsx(pt,{open:$e||!!c?.status,onOpenChange:t=>{t||F(!1)},children:e.jsxs(ht,{className:"sm:max-w-[425px]",children:[e.jsxs(gt,{children:[e.jsxs(ft,{className:"flex items-center gap-3 text-green-600",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-green-600"})}),"Success!"]}),e.jsxs(yt,{className:"pt-4 text-base",children:[c?.status||"Ride request sent successfully!",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-gray-600 mt-2 block",children:"Your ride request has been submitted. You'll receive updates once a driver accepts your request."})]})]}),e.jsxs(bt,{className:"gap-2 sm:gap-0",children:[e.jsx(Le,{variant:"outline",onClick:()=>{F(!1)},className:"border-gray-300 hover:bg-gray-50",children:"Close"}),e.jsx(Le,{onClick:()=>{F(!1),De.visit("/tropiride/profile")},className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white",children:"View My Bookings"})]})]})})]})}export{Ut as default};
